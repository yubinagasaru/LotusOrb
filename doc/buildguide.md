# Build Guide
 
## 部品
### キット付属品

| ![pcb](TODO_pcb.jpg)  | ![sensor](TODO_sensor.jpg) | ![case\_top](TODO_topcase.jpg) | ![case\_bottom](TODO_bottomcase.jpg) |
| --------------------- | -------------------------- | ------------------------------ | ------------------------------------ |
| **LotusOrb PCB × 1枚** | **PMW3360 センサーモジュール × 2個** | **トップケース（PLA）× 1個**            | **ボトムケース（PLA）× 1個**                  |
| ![screw\_4mm](TODO_screw_4mm.jpg) | ![bearing](TODO_bearing.jpg)    | ![parallel\_pin](TODO_parallel_pin.jpg) | ![rubber\_foot](TODO_rubber.jpg) |
| --------------------------------- | ------------------------------- | --------------------------------------- | -------------------------------- |
| **M2 ネジ（4mm）×10本**（使用8＋予備2）       | **ベアリング × 6個**（内径2 / 外径6 / 厚さ3） | **平行ピン × 6本**（直径2mm × 長さ8mm）            | **滑り止めシール × 8枚**                 |



### キット以外に必要なもの

| 名前                | 数   | 備考                                                         | 購入先候補URL                                   |
| ----------------- | --- | ---------------------------------------------------------- | ------------------------------------------ |
| RP2040 Core-A     | 2枚  | 左右に1枚ずつ                                                    | [https://example.com](https://example.com) |
| PMW3360 センサーモジュール | 2個  | 左右のトラックボール用                                                | [https://example.com](https://example.com) |
| TRRS ケーブル（4極）     | 1本  | **TRS（3極）では動作しません**                                        | [https://example.com](https://example.com) |
| 34mm トラックボール      | 2個  | 左右に1個ずつ                                                    | [https://example.com](https://example.com) |
| USB-TypeC ケーブル    | 1本  | Core-A接続用                                                  | [https://example.com](https://example.com) |
| キースイッチ（MX互換）      | 48個 | MX互換                                                       | [https://example.com](https://example.com) |
| キーキャップ（1U）        | 48個 | **Cherry推奨（親指キーが Cherry R1 を上下逆に付けると最適になるようにケース設計を調整しているため）** | [https://example.com](https://example.com) |

### あるといいもの

| ----------------- | --- | ---------------------------------------------------------- | ------------------------------------------ |
| 小手先 1.6D     | 1個  | RP2040 Core-Aのはんだ付けに便利                                                | [https://example.com](https://example.com) |

### 0. 部品確認

組み立てを始める前に、以下を確認してください。

- **キット付属品** がすべて揃っていること  
- **「キット以外に必要なもの」** を事前に用意していること  
![IMG20251206183855](https://github.com/user-attachments/assets/56d46458-bf0a-4e29-ac0c-475a2ff644da)

組み立て前の準備として、以下の作業も行ってください。

- PCB の周囲のタブを割って切り離し、**切断面を軽くやすりがけして整える**  



### 1. RP2040 Core-A

- RP2040 Core-Aの準備を写真の向きで直接基板にはんだ付けしてください｡(ピンヘッダーは位置合わせ用途以外では不要です)
- 以下の紫さんの｢RP2040-Tinyの取り付け｣の章の取り付けのコツの記載がわかりやすいので､参照してください https://note.com/akasha_min/n/n92db89516a20
 
### 2. PMW3360 センサーモジュール

  トラックボールセンサー（PMW3360）を基板裏面から写真の向きに設置し、はんだ付けを行います。シルクの●●印と基板の●●印の位置が合うように注意してください。  
  ![cocot46plus_bg_02_1](https://user-images.githubusercontent.com/88039287/205928430-625ecfc4-35e9-42b1-a5d7-df5b4f9352da.jpg)

  ひっくり返して裏面からすべての足をはんだ付けします。センサーに貼られているテープもこのタイミングではがしておきます。  
  LotusOrb PCBと､センサーモジュールをFPCケーブルで接続します｡FPCコネクタのロックレバーを開き、FPCの導体面を下にしてコネクタに対して垂直に、奥までしっかり挿入し、最後にロックレバーを閉じてください｡同様にケーブルの向きは以下の写真を参照してください｡
  ![cocot46plus_bg_02_3](https://user-images.githubusercontent.com/88039287/205928856-9a40670c-a4d4-49a2-89fb-7ac671164bfb.jpg)
  
## 3. ファームウェア
  [REMAP](https://remap-keys.app/catalog/JPk6Ey9xB6yrr5TDqoLh/firmware)からファームウェアのダウンロードしてください｡
  RP2040 Core-Aのスイッチを押しながらケーブルを接続すると､書き込みを行うことができるので､先程ダウンロードしたファイルをドラッグドロップしてください｡
  左右でファームが違うので､注意して書き込んでください｡
  ファームウェア書き込み後Vialにて､Matrix Testを実施し､すべてのキーが正しく反応しているかを確認してください｡
  また､センサーモジュールの前で指を動かし､センサーが反応しているかを確認してください｡(右手トラックボールがカーソル移動､左手トラックボールが右手トラックボールがスクロールです)

### 3. 組み立て
  ベアリングを平行ピンにはめ､トップケースのトラックボール部分にはめ込んでください(3箇所)｡コツとしては､3箇所ある程度はめたあとにトラックボールを押し込めば､しっかりと奥まで差し込まれます｡  
  ![cocot46plus_bg_06_2](https://user-images.githubusercontent.com/88039287/205934028-446aadb9-f03d-4a19-ae9d-2ac39559edea.jpg)
  
  トップケースにFPCコネクタがTRRSソケットの方向になるようにPMW3360 センサーモジュールを起き､ネジで固定します｡  
  ![cocot46plus_bg_06_2](https://user-images.githubusercontent.com/88039287/205934028-446aadb9-f03d-4a19-ae9d-2ac39559edea.jpg)
  
  トップケースにLotusOrb PCBをはめ込み､キースイッチをはめて固定していきます｡ 
  ![cocot46plus_bg_06_1](https://user-images.githubusercontent.com/88039287/205934015-431b887f-fd0d-40d4-b0bf-02f9964ecb81.jpg)

  FPCコネクタのロックレバーを開き、FPCの導体面を下にしてコネクタに対して垂直に、奥までしっかり挿入し、最後にロックレバーを閉じてください｡ケーブルの向きは以下の写真を参照してください｡
  ![cocot46plus_bg_06_2](https://user-images.githubusercontent.com/88039287/205934028-446aadb9-f03d-4a19-ae9d-2ac39559edea.jpg)
  
  ボトムケースを､トップケースに押し込み､ボトムケースにバランスよくゴム脚を貼り付けます。  
  ![cocot46plus_bg_06_9](https://user-images.githubusercontent.com/88039287/205934053-211ffc1a-3bb6-4b60-98f0-48205c640b42.jpg)

  お好みのキーキャップをつけて､ハードは完成です｡
  ![cocot46plus_bg_06_10](https://user-images.githubusercontent.com/88039287/205934057-ae4e05d5-e91a-4d3b-a659-67fa307f5c2b.jpg)

### 4. 初期設定
#### 前提情報
- LotusOrbは､右手トラックボールがカーソル移動､左手トラックボールがスクロールとなっています｡
- 右手のカーソル移動が検出されると､自動的にオートマウスレイヤー(レイヤー5)にレイヤーが遷移し､一定時間経過もしくはレイヤー5にて設定されていないキーが押されると自動で初期レイヤーに戻ります｡
- レイヤー1では左手のトラックボールが矢印キーの入力となります｡Excel等で活用してください｡

#### 4. キーコードでの初期設定の調整
レイヤー4に初期設定用のキーコードを配置しています｡お好みで調整してください｡
| キーコード     | Vialでの表示名   | 動作概要                                                                                          |
| --------- | ----------- | --------------------------------------------------------------------------------------------- |
| `VREV`    | `V-Rev`     | 縦スクロール方向が押すたびに反転します｡                                    |
| `HREV`    | `H-Rev`     | 横スクロール方向押すたびに反転します｡                                            |
| `GATE_UP` | `Gate-Up`   | オートマウスレイヤーに入るためのしきい値（`to_clickable_movement`）を大きくして、「強く動かさないとマウスレイヤーに入らない」ようにする。押すたびに＋5。      |
| `GATE_DN` | `Gate-Down` | オートマウスレイヤーに入るためのしきい値を小さくして、「少し動かしただけでマウスレイヤーに入りやすく」する。押すたびに竏鈀5（ただし最小5まで）。                  |
| `CPI_TG`  | `CPI-TG`    | PMW3360のCPI（感度）を順送りで切り替え。1000/1600/2200/2800/3400をループする。 |

レイヤー4のキーマップは下記の通りです｡
#### キーマップの更新
お好みでキーマップを更新してください｡
マウス関係のカスタムキーコードは､以下の通りです｡USERタブから選んで設定してください｡
| キーコード     | Vialでの表示名   | 動作概要                                                                                          |
| --------- | ----------- | --------------------------------------------------------------------------------------------- |
| `M_L`     | `M-L`       | マウス左クリック。押下で左ボタンを押しっぱなしにできる（ドラッグ対応）。離すと左ボタンを離す。                                               |
| `M_R`     | `M-R`       | マウス右クリック。押下で右ボタンを押しっぱなしにできる。離すと右ボタンを離す。                                                       |
| `M_M`     | `M-M`       | マウス中クリック。押下で中ボタンを押しっぱなしにできる。離すと中ボタンを離す。                                                       |
| `SCRL`    | `Scroll`    | スクロールモード切り替え。押している間はトラックボールの動きがスクロールに割り当てられ、離すと通常のマウスレイヤーに戻る。                                 |


## 終わりに
何かトラブルがあれば､購入したチャンネルよりご連絡ください(Booth or X)。
また、完成写真をSNSにアップいただけるととても私がめっちゃ喜びます｡
ハッシュタグは #LotusOrb です。
